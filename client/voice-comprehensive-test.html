<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Editor Comprehensive Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h3><i class="fas fa-microphone-alt me-2"></i>Voice Editor Comprehensive Test</h3>
                    </div>
                    
                    <!-- Voice Editor Section -->
                    <div id="voiceEditorSection" class="card-body border-bottom">
                        <div class="text-center py-3">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading Voice Editor...</span>
                            </div>
                            <p class="mt-2 text-muted">Initializing Voice Editor...</p>
                        </div>
                    </div>
                    
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle me-2"></i>Test Commands:</h6>
                            <ul class="mb-0">
                                <li><strong>Name:</strong> "Update my name to John Smith"</li>
                                <li><strong>Email:</strong> "Change email to john@example.com"</li>
                                <li><strong>Phone:</strong> "Set phone number to five five five one two three four five six seven"</li>
                                <li><strong>Skills:</strong> "Add skill JavaScript" or "Add skill Python programming"</li>
                                <li><strong>Objective:</strong> "Update my objective to seeking new opportunities in technology"</li>
                                <li><strong>Control:</strong> "Help" or "Stop listening"</li>
                            </ul>
                        </div>
                        
                        <form id="resumeForm">
                            <!-- Personal Information -->
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="fullName" class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="fullName" name="fullName">
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" name="email">
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="phone" class="form-label">Phone</label>
                                    <input type="tel" class="form-control" id="phone" name="phone">
                                </div>
                                <div class="col-md-6">
                                    <label for="address" class="form-label">Address</label>
                                    <input type="text" class="form-control" id="address" name="address">
                                </div>
                            </div>
                            
                            <!-- Skills -->
                            <div class="mb-3">
                                <label for="keySkills" class="form-label">Key Skills</label>
                                <input type="text" class="form-control" id="keySkills" name="keySkills" placeholder="Type and press Enter to add skills">
                                <div class="skills-container mt-2" id="skillsContainer"></div>
                            </div>
                            
                            <!-- Career Objective -->
                            <div class="mb-3">
                                <label for="careerObjective" class="form-label">Career Objective</label>
                                <textarea class="form-control" id="careerObjective" name="careerObjective" rows="3" placeholder="Describe your career objective..."></textarea>
                            </div>
                            
                            <!-- Test Results Display -->
                            <div class="card mt-4">
                                <div class="card-header">
                                    <h6><i class="fas fa-chart-line me-2"></i>Form Field Values (Live Updates)</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <strong>Name:</strong> <span id="displayName" class="text-muted">Not set</span><br>
                                            <strong>Email:</strong> <span id="displayEmail" class="text-muted">Not set</span><br>
                                            <strong>Phone:</strong> <span id="displayPhone" class="text-muted">Not set</span><br>
                                        </div>
                                        <div class="col-md-6">
                                            <strong>Skills:</strong> <span id="displaySkills" class="text-muted">None added</span><br>
                                            <strong>Objective:</strong> <span id="displayObjective" class="text-muted">Not set</span><br>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="voiceEditor.js"></script>
    
    <script>
        // Initialize Voice Editor when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Test page DOM loaded, initializing Voice Editor...');
            
            // Wait a bit for VoiceEditor script to load
            setTimeout(function() {
                if (typeof VoiceEditor !== 'undefined' && typeof VoiceEditor.init === 'function') {
                    try {
                        console.log('üìû Calling VoiceEditor.init()...');
                        const success = VoiceEditor.init();
                        if (success) {
                            console.log('‚úÖ Voice Editor initialized successfully');
                        } else {
                            console.warn('‚ö†Ô∏è Voice Editor init returned false');
                        }
                    } catch (error) {
                        console.error('‚ùå Voice Editor initialization failed:', error);
                    }
                } else {
                    console.error('‚ùå VoiceEditor not found');
                    const voiceSection = document.getElementById('voiceEditorSection');
                    if (voiceSection) {
                        voiceSection.innerHTML = `
                            <div class="alert alert-danger text-center">
                                <i class="fas fa-times-circle me-2"></i>
                                Voice Editor not available. Please ensure voiceEditor.js is loaded properly.
                            </div>
                        `;
                    }
                }
            }, 100);
            
            // Setup live field monitoring
            setupLiveMonitoring();
        });
        
        // Live monitoring of form field changes
        function setupLiveMonitoring() {
            console.log('üìä Setting up live monitoring of form fields');
            
            const fields = {
                fullName: document.getElementById('fullName'),
                email: document.getElementById('email'),
                phone: document.getElementById('phone'),
                keySkills: document.getElementById('keySkills'),
                careerObjective: document.getElementById('careerObjective')
            };
            
            const displays = {
                fullName: document.getElementById('displayName'),
                email: document.getElementById('displayEmail'),
                phone: document.getElementById('displayPhone'),
                keySkills: document.getElementById('displaySkills'),
                careerObjective: document.getElementById('displayObjective')
            };
            
            // Function to update display
            function updateDisplay() {
                displays.fullName.textContent = fields.fullName.value || 'Not set';
                displays.email.textContent = fields.email.value || 'Not set';
                displays.phone.textContent = fields.phone.value || 'Not set';
                displays.careerObjective.textContent = fields.careerObjective.value || 'Not set';
                
                // Check skills container for added skills
                const skillsContainer = document.getElementById('skillsContainer');
                const skillTags = skillsContainer ? skillsContainer.querySelectorAll('.skill-tag') : [];
                if (skillTags.length > 0) {
                    const skillsList = Array.from(skillTags).map(tag => tag.textContent.replace('√ó', '').trim()).join(', ');
                    displays.keySkills.textContent = skillsList;
                } else {
                    displays.keySkills.textContent = 'None added';
                }
            }
            
            // Add event listeners
            Object.values(fields).forEach(field => {
                if (field) {
                    field.addEventListener('input', updateDisplay);
                    field.addEventListener('change', updateDisplay);
                }
            });
            
            // Monitor for dynamically added skills
            const skillsContainer = document.getElementById('skillsContainer');
            if (skillsContainer) {
                const observer = new MutationObserver(updateDisplay);
                observer.observe(skillsContainer, { childList: true, subtree: true });
            }
            
            // Initial update
            updateDisplay();
            
            // Periodic update for testing
            setInterval(updateDisplay, 1000);
        }
    </script>
</body>
</html>
